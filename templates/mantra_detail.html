{% extends "base.html" %}
{% block content %}
<h2>{{ mantra.name }}</h2>
<p>Syllables: {{ mantra.syllables }}</p>
<p>Purascharana Count: {{ mantra.purascharana_count }}</p>
<p>Current Status: {{ mantra.entries | sum(attribute='count') }}</p>

<h4>Edit Mantra</h4>
<form method="post" action="{{ url_for('main.edit_mantra', mantra_id=mantra.id) }}">
    <div class="mb-2">
        <label>Name:</label>
        <input type="text" name="name" value="{{ mantra.name }}" class="form-control" required>
    </div>
    <div class="mb-2">
        <label>Syllables:</label>
        <input type="number" name="syllables" value="{{ mantra.syllables }}" class="form-control" required>
    </div>
    <button type="submit" class="btn btn-success">Save Changes</button>
    <a href="{{ url_for('main.delete_mantra', mantra_id=mantra.id) }}" class="btn btn-danger" onclick="return confirm('Delete this mantra?')">Delete Mantra</a>
</form>

<h4 class="mt-4">Add Entry</h4>
<form method="post" action="{{ url_for('main.add_entry', mantra_id=mantra.id) }}">
    <input type="date" name="date" required>
    <input type="number" name="count" placeholder="Count" required>
    <button type="submit" class="btn btn-primary">Add Entry</button>
</form>

<h4 class="mt-4">Entries</h4>
{% if mantra.entries %}
<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Count</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        {% for entry in mantra.entries %}
        <tr>
            <td>{{ entry.date }}</td>
            <td>{{ entry.count }}</td>
            <td><a href="{{ url_for('main.delete_entry', entry_id=entry.id) }}" class="btn btn-danger btn-sm" onclick="return confirm('Delete this entry?')">Delete</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>No entries.</p>
{% endif %}

<a href="{{ url_for('main.mantra_records') }}" class="btn btn-secondary">Back to Mantra Records</a>
{% endblock %}
